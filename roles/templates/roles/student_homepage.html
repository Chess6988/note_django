{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid">
    
    <div class="row min-vh-100">
        <!-- Sidebar Toggle Button (visible on mobile) -->
        <button class="btn btn-primary d-md-none m-2" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
            ‚ò∞ Menu
        </button>

        <!-- Sidebar Navigation -->
        <aside id="sidebarMenu" class="collapse d-md-flex col-12 col-md-3 col-lg-2 bg-primary text-white flex-column p-3">
           
            <nav class="nav nav-pills flex-column">
                <a href="{% url 'roles:student_homepage' %}" class="nav-link text-white mb-2">
                    <i class="bi bi-speedometer2 me-2"></i>Tableau de Bord
                </a>
                <a href="{% url 'roles:etudiant_dashboard' %}" class="nav-link text-white mb-2">
                    <i class="bi bi-person-circle me-2"></i>Profil
                </a>
                <a href="{% url 'roles:logout' %}" class="nav-link text-white">
                    <i class="bi bi-box-arrow-right me-2"></i>D√©connexion
                </a>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="col-md-9 col-lg-10 py-4">
                    </section>

        <style>
   
        
       
.container-fluid > .row {
    margin-left: 0 !important;
    margin-right: 0 !important;
}

#sidebarMenu {
    padding-left: 0 !important;
    padding-right: 0 !important;
    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.05);
}

/* Enhanced main area contrast */
main.col-md-9.col-lg-10 {
    flex: 1 1 auto;
    width: 100% !important;
    margin-left: 0 !important;
    padding-left: 2rem !important;
    padding-right: 2rem !important;
    background-color: #f8f9fa; /* light gray background */
}
</style>

        </style>

            <!-- Success Modal -->
            <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="successModalLabel">Succ√®s</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Informations enregistr√©es avec succ√®s.
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Fermer</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Welcome Section -->
            <section class="mb-4">
                <h1 class="h3 text-primary fw-semibold text-capitalize">Bienvenue, {{ student.user.username|title }}üëã </h1>
                <p class="text-muted">Institut Management et Entrepreneuriat, Yaound√© - Ann√©e Acad√©mique {{ current_year }}</p>
            </section>

            <!-- Profile Section -->
            <section class="mb-4 card p-3 border-0 shadow-sm">
                <h2 class="h5 text-primary mb-3">Profil Acad√©mique</h2>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Nom:</strong> <span class="text-capitalize">{{ student.user.username|title }}</span></p>
                        <p><strong>Fili√®re:</strong> {{ student.profileetudiant_set.last.filiere.nom_filiere }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Niveau:</strong> {{ student.profileetudiant_set.last.niveau.nom_niveau }}</p>
                        <p><strong>Semestre:</strong> {{ student.profileetudiant_set.last.semestre.nom_semestre }}</p>
                    </div>
                </div>
                <p><strong>Ann√©e Acad√©mique:</strong> {{ current_year }}</p>
                <a href="{% url 'roles:etudiant_dashboard' %}" class="btn btn-primary">Modifier le Profil</a>
            </section>

            <!-- Subjects Table -->
            <section class="mb-4 card p-3 border-0 shadow-sm">
                <h2 class="h5 text-primary mb-3">Mati√®res Inscrites</h2>
                <div class="table-responsive">
                    <table class="table table-bordered table-hover">
                        <thead class="table-light">
                            <tr class="px-2 py-1">
                                <th>Code</th>
                                <th>Mati√®re</th>
                                <th>Type de matiere</th>
                                <th>Semestre</th>
                                <th>Niveau</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody class="px-2 py-1">
                            {% for matiere in student.matiereetudiant_set.all %}
                            <tr>
                                <td>{{ matiere.matiere.course_code }}</td>
                                <td>{{ matiere.matiere.nom_matiere }}</td>
                                <td>Sp√©cifique</td>
                                <td>{{ matiere.matiere.semestre.nom_semestre }}</td>
                                <td>{{ matiere.matiere.niveau.nom_niveau }}</td>
                                <td>-</td>
                            </tr>
                            {% endfor %}
                            {% for matiere_commune in student.matierecommuneetudiant_set.all %}
                            <tr>
                                <td>{{ matiere_commune.matiere_commune.course_code }}</td>
                                <td>{{ matiere_commune.matiere_commune.nom_matiere_commune }}</td>
                                <td>Commun</td>
                                <td>{{ matiere_commune.matiere_commune.semestre.nom_semestre }}</td>
                                <td>{{ matiere_commune.matiere_commune.niveau.nom_niveau }}</td>
                                <td>-</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Announcements -->
            <section class="card p-3 border-0 shadow-sm">
                <h2 class="h5 text-primary mb-3">Annonces</h2>
                <p class="text-muted">Chargement des annonces...</p>
            </section>

            {% block footer %}
            <footer class="bg-primary text-white py-3 mt-5">
                <div class="container text-center">
                    <p class="mb-0">¬© {{ current_year }} Institut de Management et de l'Entrepreneuriat (IME). Tous droits r√©serv√©s.</p>
                    <p class="mb-0">Contact : info@ime.cm | +237 123 456 789</p>
                </div>
            </footer>
            {% endblock %}
        </main>
    </div>
</div>
{% endblock %}

<script>
// Auto-dismiss Bootstrap alerts after 10 seconds
window.addEventListener('DOMContentLoaded', function() {
    var alerts = document.querySelectorAll('.alert');
    alerts.forEach(function(alert) {
        setTimeout(function() {
            if (alert.classList.contains('show')) {
                alert.classList.remove('show');
                setTimeout(function() { alert.style.display = 'none'; }, 150);
            } else {
                alert.style.display = 'none';
            }
        }, 10000);
    });
});
</script>
